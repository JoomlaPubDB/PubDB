<!DOCTYPE html>
<html>
  <head>
    <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  </head>
  <style>
    .area {
      height: 100px;
      background-color: grey;
      display: flex;
      flex-direction: row;
      align-items: center;
    }
    .block {
      border-width: 2px;
      border-style: solid;
      padding-left: 10px;
      padding-right: 10px;
      border-color: black;
      margin-right: 10px;
    }
    .container {
      display: flex;
      flex-direction: row;
      justify-content: center;
      height: 100px;
      align-items: center;
    }
    .delete {
      margin: 50px;
      background-color: hotpink;
      width: 100px;
      height: 100px;
    }
  </style>
  <body>
    <div style="display: flex; flex-direction: column;">
      <div id="container">
        <ol style="list-style-type: none;" class="container" id="fixlist"></ol>
      </div>
      <div class="area">
        <ol
          style="list-style-type: none;"
          class="container"
          id="orderedlist"
        ></ol>
      </div>
      <textarea
        id="text"
        style="align-self: center; margin-top: 10px;"
      ></textarea>
      <button
        onclick="submitClicked()"
        style="align-self: center; margin-top: 10px;"
      >
        Submit
      </button>
    </div>
  </body>

  <script type="text/javascript">
    var blocks;
    var arrayString = [];

    function submitClicked() {
      if (document.getElementById("text").value == "") {
        arrayString = [];
        var ol = document.getElementById("orderedlist");
        var items = ol.getElementsByTagName("li");
        for (var i = 0; i < items.length; ++i) {
          for (y in blocks) {
            if ($(items[i]).hasClass(y)) {
              arrayString.push(y);
            }
          }
        }
        var textField = document.getElementById("text");
        var txt = arrayString.toString();
        textField.value = txt;
      } else {
        $("#orderedlist").empty();
        var fieldText = document.getElementById("text").value;
        var newArray = fieldText.split(",");
        newArray.forEach(function (item, index) {
          var li = document.createElement("li");
          $(li).addClass("block fromArray");
          $(li).addClass(item);
          var content = document.createTextNode(blocks[item]);
          li.appendChild(content);
          $(li).draggable({
            connectToSortable: "#orderedlist",
            revert: function (valid) {
              if (!valid) {
                $(this).remove();
                document.getElementById("text").value = "";
              } else {
                return true;
              }
            },
          });
          var ol = document.getElementById("orderedlist");
          ol.appendChild(li);
        });
      }
    }

    $(document).ready(function () {
      document.getElementById("text").value = "";
      $("#orderedlist").sortable();

      blocks = {
        1: "Vorname",
        2: "Nachname",
        3: "Verlag",
        4: "Erscheinungsjahr",
        5: "Seitenzahl",
      };

      Object.entries(blocks).forEach(([key, value]) => {
        var li = document.createElement("li");
        $(li).addClass("block original");
        $(li).addClass(key);
        var content = document.createTextNode(value);
        li.appendChild(content);
        var ol = document.getElementById("fixlist");
        ol.appendChild(li);
      });

      $(".block").draggable({ helper: "clone", revert: "invalid" });

      $(".area").droppable({
        accept: ".original, .cloned, .fromArray",
        drop: function (ev, ui) {
          if ($(ui.draggable).hasClass("original")) {
            document.getElementById("text").value = "";
            var element = ui.draggable.clone();
            $(element).addClass("cloned");
            $(element).removeClass("original");
            $(element).draggable({
              connectToSortable: "#orderedlist",
              revert: function (valid) {
                if (!valid) {
                  $(this).remove();
                  document.getElementById("text").value = "";
                } else {
                  $('.cloned').css('top', 'auto').css('left', 'auto');
                  return false;
                }
              },
            });
            $("#orderedlist").append(element);
          }
        },
      });
    });
  </script>
</html>
